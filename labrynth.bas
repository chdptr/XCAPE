100 MS=10:REM MAZE SIZE
110 DIM S(MS+1,MS+1):REM SOUTH WALLS
120 DIM W(MS+1,MS+1):REM WEST WALLS
130 DIM V(MS+1,MS+1):REM VISITED CELLS
150 GOSUB 260:REM INITIALIZE MAZE
170 DIM PC(MS*MS+1):DIM PR(MS*MS+1):REM STACK
180 REM PICK RANDOM STARTING CELL
190 X = RND(-TI)
200 C=(INT(RND(1)*MS)+1)
210 R=(INT(RND(1)*MS)+1)
220 GOSUB 400:REM BUILD MAZE
230 GOSUB 540:REM DRAW MAZE
240 END
250 REM -----INITIALIZE MAZE-----
260 REM SET WALLS ON AND VISITED CELLS OFF
270 T=MS+1
280 FOR C=0 TO T:FOR R=0 TO T:
290 S(C,R)=1:W(C,R)=1:V(C,R)=0
300 NEXT R:NEXT C
310 REM SET BORDER CELLS TO VISITED
320 FOR C=0 TO T
330 V(C,0)=1:V(C,T)=1
340 NEXT C
350 FOR R=0 TO T
360 V(0,R)=1:V(T,R)=1
370 NEXT R
380 RETURN
390 REM -----BUILD MAZE-----
400 U=U+1:PC(U)=C:PR(U)=R:REM PUSH
410 V(C,R)=1
420 IF V(C,R+1)=1 AND V(C+1,R)=1 AND V(C,R-1)=1 AND V(C-1,R)=1 THEN GOTO 500
430 Z=INT(RND(1)*4)
440 IF Z=0 AND V(C,R+1)=0 THEN S(C,R)=0:R=R+1:GOTO 400
450 IF Z=1 AND V(C+1,R)=0 THEN W(C+1,R)=0:C=C+1:GOTO 400
460 IF Z=2 AND V(C,R-1)=0 THEN S(C,R-1)=0:R=R-1:GOTO 400
470 IF Z=3 AND V(C-1,R)=0 THEN W(C,R)=0:C=C-1:GOTO 400
480 GOTO 430
500 C=PC(U):R=PR(U):U=U-1:REM POP
510 IF U > 0 THEN GOTO 420
520 RETURN
530 REM -----DRAW MAZE-----
540 REM OPEN 4,4:CMD 4:REM SEND OUTPUT TO PRINTER
550 PRINT "QCCQCCQCCQCCQCCQCCQCCQCCQCCQCCQ"
560 FOR R = 1 TO MS
570 FOR C = 1 TO MS+1
580 IF W(C,R)=0 THEN PRINT "   ";
590 IF W(C,R)=1 THEN PRINT "G  ";
600 NEXT C
610 PRINT
620 FOR C = 1 TO MS
630 IF S(C,R)=0 THEN PRINT "Q  ";
640 IF S(C,R)=1 THEN PRINT "QCC";
650 NEXT C
660 PRINT "Q"
670 NEXT R
675 POKE(1024+0+39*40),128
680 REM PRINT#4:CLOSE 4:REM CLOSE PRINTER DEVICE
684 PX=1:PY=4:PP=90:SC=0:MX=9
686 POKE(1024+33+4*40), 19
687 POKE(1024+34+4*40), 3
688 POKE(1024+35+4*40), 15
689 POKE(1024+36+4*40), 18
690 POKE(1024+37+4*40), 5
692 POKE(1024+35+6*40), 48
693 POKE1024+PX+PY*40, PP
694 REM OBJECT GENERATION
695 GG=0
696 DX=INT(RND(1)*29)+1:DY=INT(RND(1)*19)+4
698 IF PEEK(1024+DX+DY*40)=32 THEN GG=GG+1
700 IF PEEK(1024+DX+DY*40)=32 THEN POKE(1024+DX+DY*40), 83
702 IF GG<>MX THEN GOTO696  
781 REM END GENERATION
782 GET A$
783 OX=PX
784 OY=PY
785 IF A$="D" AND PEEK(1024+PX+1+PY*40)=32 OR PEEK(1024+PX+1+PY*40)=83 THEN PX=PX+1
786 IF A$="A" AND PEEK(1024+PX-1+PY*40)=32 OR PEEK(1024+PX-1+PY*40)=83 THEN PX=PX-1 
796 IF A$="S" AND PEEK(1024+PX+(PY+1)*40)=32 OR PEEK(1024+PX+(PY+1)*40)=83 THEN PY=PY+1
797 IF A$="W" AND PEEK(1024+PX+(PY-1)*40)=32 OR PEEK(1024+PX+(PY-1)*40)=83 THEN PY=PY-1
807 IF PEEK(1024+PX+PY*40)=83 THEN SC=SC+1
817 POKE(1024+35+6*40), 48+SC
996 IF OX <> PX OR OY <> PY THEN POKE1024+OX+OY*40, 32
997 X=1024+PX+PY*40
999 POKE X, PP
1004 IF SC=MX THEN GOTO1010
1009 GOTO 782
1010 POKE(1024+34+8*40), 8
1020 POKE(1024+35+8*40), 1
1030 POKE(1024+36+8*40), 9
1040 POKE(1024+33+9*40), 22
1050 POKE(1024+34+9*40), 9
1060 POKE(1024+35+9*40), 14
1070 POKE(1024+36+9*40), 20
1080 POKE(1024+37+9*40), 15